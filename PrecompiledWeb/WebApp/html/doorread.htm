<html>
  <head>
    <title>读取门禁参数</title>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
    <base target="_self" />
    <script language="javascript" src="hmjs/sysjs/Calendar30.js" type="text/javascript" charset="gb2312"></script>
    <script language="javascript" src="hmjs/sysjs/times.js" type="text/javascript" charset="gb2312"></script>
    <link href="hmjs/sysjs/calendar.css" type="text/css" charset="gb2312" rel="stylesheet" />
    <link href="hmjs/sysjs/inputctrl.css" type="text/css" charset="gb2312" rel="stylesheet" />
    <link href="mstoolbar_files/css.css" type="text/css" rel="stylesheet" />
    <link href="CSS/mWindow800.css" rel="stylesheet" type="text/css" />    
    <style type="text/css">
      BODY { FONT-SIZE: 9pt; COLOR: #333333; FONT-FAMILY: "宋体", "Arial" }
      TD { FONT-SIZE: 9pt; COLOR: #333333; FONT-FAMILY: "宋体", "Arial" }
      .tdclass {width:100px;height:25px}
       .standbtn{width:80px;} 
    </style>
    
    <script type="text/javascript" charset="gb2312">
	
	    function initWin()
	    {
            var ob=$band("门禁权限");
            ob.Asyn=true;
            ob.XQuery();
            ob.AfterXQuery = function()
            {
                ue_expand('门禁权限',true);
                  ue_treeline("门禁权限",true);
                    $loading("none");
            }
                            
          
	    }
	    
        function Tree_onNodeSelectionChange(node)
        {
            TclickDot(node,false);
        }	    
	
	</script>
    
    
  </head>
  <body style="overflow:hidden; margin: 0px;" scroll="no">
    <script language="javascript" src="hmjs/sysjs/GridUtilXSLT.js" type="text/javascript" charset="gb2312"></script>
    <script language="javascript" src="hmjs/sysjs/usXmlLandCal.js" type="text/javascript" charset="gb2312"></script>
    <script language="javascript" src="hmjs/sysjs/usValidation.js" type="text/javascript" charset="gb2312"></script>
    <div style="display:none;">
      <XML id="xmlparam" typexml="Param">
        <D>
          <PL t="P">
            <L t="Ts">
              <P n="RecordCount" v="" t="s" pt="M" />
              <P n="Command" v="TransParam" t="s" />
              <P n="UnitName" v="门禁读取" t="s" />
            </L>
          </PL>
        </D>
      </XML>
    </div>
    <div style="display:none;">
      <XML name="门禁读取" templatetype="SIMPL" id="xmlConf_xmlLandConf" typexml="ConfProperty" confpro="" tpath="">
        <UnitItem>
          <Item name="edit" relation="M" dataitem="doorset"></Item>
        </UnitItem>
      </XML>
    </div>
      <div style="display:none" >
        <input name="hlb_cmd" type="hidden" id="hlb_cmd" />
        <input type="submit" name="bt_PostBack" value="PostBack" id="bt_PostBack" style="height:1px;" />
        <input name="hlbRequestParams" type="hidden" id="hlbRequestParams" />
      </div>
        <head>
          <script language="javascript" src="hmjs/sysjs/winLoadUtil.js" type="text/javascript" charset="gb2312"></script>
          <script language="javascript" src="hmjs/sysjs/GridUtilBase.js" type="text/javascript" charset="gb2312"></script>
          <script language="javascript" src="hmjs/sysjs/usCommonBase.js" type="text/javascript" charset="gb2312"></script>
          <script language="javascript" src="hmjs/sysjs/usUnitBase.js" type="text/javascript" charset="gb2312"></script>
          <script language="javascript" src="hmjs/sysjs/usBandBase.js" type="text/javascript" charset="gb2312"></script>
          <script language="javascript" src="hmjs/sysjs/htminit.js" type="text/javascript" charset="gb2312"></script>
          <script language="javascript" src="hmjs/sysjs/usTreeLand.js" type="text/javascript" charset="gb2312"></script>
          <script language="javascript" src="hmjs/tmpjs/ocwintable.js" type="text/javascript" charset="gb2312"></script>
          <script language="javascript" src="hmjs/tmpjs/doorread.js" type="text/javascript" charset="gb2312"></script>
          <link href="hmjs/sysjs/inputctrl.css" type="text/css" charset="gb2312" rel="stylesheet" />
          <link href="hmjs/sysjs/css.css" type="text/css" charset="gb2312" rel="stylesheet" />
          <link href="hmjs/sysjs/treeStyle.css" type="text/css" rel="stylesheet" />
        </head>
        <body bgcolor="#edebe8">
          <table style="BORDER-COLLAPSE: collapse; HEIGHT:100%;width:100%" cellSpacing="2" cellPadding="0" border="1">
            <tbody>
              <tr>
                <td style="height: 23px" vAlign="middle" background="images/bkgray-s.gif" colSpan="3">
                    <strong>　门禁参数读取功能选择： </strong>
                        <input id="fun1" type="radio" value="0" onclick="secBoard(0)" checked name="dfun"><label for="fun1" style="cursor:hand">采集开门记录</label>
                        <input id="fun2" type="radio" value="1" onclick="secBoard(1);gridinit('tableDiv');" name="dfun"><label for="fun2" style="cursor:hand">读取白名单</label>
                        <input id="fun3" type="radio" value="2" onclick="secBoard(2);gridinit('devinfo');" name="dfun"><label for="fun3" style="cursor:hand">读取设备信息</label>
                </td>
              </tr>
              <tr>
                <td style="width:20%; border-right-style:none; border-right-width:medium" vAlign="top" align="left">
                  <fieldset style="padding: 10;width:100%;height:95%;border:1px inset">
                  <legend style="padding:1px;">门禁控制器<input type="checkbox" name="chkdoor" value="all" title="全选" onclick="_selectalldoor()"></legend>
                          <div style="display:none;">
                            <XML id="treeland_dict" typexml="Dict" itemname="edit">
                              <Dict></Dict>
                            </XML>
                          </div>
                          <script src="hmjs/sysjs/treeres1.js" type="text/javascript"></script>
                          <script src="hmjs/sysjs/treeres2.js" type="text/javascript"></script>
                          <script src="hmjs/sysjs/treeres3.js" type="text/javascript"></script>
                          <script src="hmjs/sysjs/treeres4.js" type="text/javascript"></script>
                          <script src="hmjs/sysjs/treeres5.js" type="text/javascript"></script>
                          <script src="hmjs/sysjs/treeres6.js" type="text/javascript"></script>
                          <script type="text/javascript">
                            //<![CDATA[
                              window.ComponentArt_Storage_etpTemplate_treeland_trvLand = null;
                            //]]>
                          </script>
                          <div style="position:absolute;top:0px;left:0px;visibility:hidden;">
                            <img src="images/exp.gif" width="0" height="0" alt="" />
                            <img src="images/col.gif" width="0" height="0" alt="" />
                          </div>
                          <div id="etpTemplate_treeland_trvLand" class="TreeView" style="height:100%;width:100%;overflow:hidden;" onclick="if(window.etpTemplate_treeland_trvLand_loaded) ComponentArt_SetKeyboardFocusedTree(this, etpTemplate_treeland_trvLand);" onmouseover="if(window.etpTemplate_treeland_trvLand_loaded) ComponentArt_SetActiveTree(etpTemplate_treeland_trvLand);"></div>
                            <script type="text/javascript">
          //<![CDATA[
                    window.ComponentArt_Init_etpTemplate_门禁权限Tab_trvLand = function() {
                    if(!window.ComponentArt_TreeView_Kernel_Loaded || !window.ComponentArt_TreeView_Keyboard_Loaded || !window.ComponentArt_TreeView_Support_Loaded || !window.ComponentArt_Utils_Loaded || !window.ComponentArt_Keyboard_Loaded || !window.ComponentArt_DragDrop_Loaded || !document.getElementById('etpTemplate_门禁权限Tab_trvLand'))
                        {setTimeout('ComponentArt_Init_etpTemplate_门禁权限Tab_trvLand()', 100); return; }

                    window.etpTemplate_门禁权限Tab_trvLand = new ComponentArt_TreeView('etpTemplate_门禁权限Tab_trvLand', ComponentArt_Storage_etpTemplate_门禁权限Tab_trvLand);
                    etpTemplate_门禁权限Tab_trvLand.Postback = function() { __doPostBack('etpTemplate$门禁权限Tab$trvLand','') };
                    if(!window['trvLand']) { window['trvLand'] = window.etpTemplate_门禁权限Tab_trvLand; etpTemplate_门禁权限Tab_trvLand.GlobalAlias = 'trvLand'; }
                    etpTemplate_门禁权限Tab_trvLand.Properties = [['ApplicationPath','/HMApp'],['ClientEvents',{'NodeMouseDoubleClick':TreeUtil.onNodeDoubleClick}],['ClientSideOnNodeSelect','TreeUtil.onNodeSelectionChange'],['ClientTemplates',[]],['CollapseSlide',2],['CollapseDuration',200],['CollapseTransition',0],['CollapseImageUrl','images/exp.gif'],['ControlId','etpTemplate:门禁权限Tab:trvLand'],['CssClass','TreeView'],['DefaultImageHeight',0],['DefaultImageWidth',0],['MarginImageHeight',0],['MarginImageWidth',0],['DragAndDropAcrossTreesEnabled',true],['DragHoverExpandDelay',700],['Enabled',true],['EnableViewState',true],['ExpandSlide',2],['ExpandDuration',200],['ExpandTransition',0],['ExpandCollapseImageHeight',0],['ExpandCollapseImageWidth',0],['ExpandImageUrl','images/col.gif'],['ExpandSelectedPath',true],['HoverNodeCssClass','HoverTreeNode'],['ItemSpacing',0],['LineImageHeight',0],['LineImageWidth',0],['LineImagesFolderUrl','images/lines/'],['LoadingFeedbackText','Loading...'],['MarginWidth',32],['MultipleSelectEnabled',true],['NodeCssClass','TreeNode'],['NodeLabelPadding',0],['NodeIndent',16],['SelectedNodeCssClass','SelectedTreeNode'],];
                    etpTemplate_门禁权限Tab_trvLand.Initialize('etpTemplate_门禁权限Tab_trvLand');

                    window.etpTemplate_门禁权限Tab_trvLand_loaded = true;
                }
                ComponentArt_Init_etpTemplate_门禁权限Tab_trvLand();
                var myTree = new Tree(etpTemplate_门禁权限Tab_trvLand,'门禁权限Tab');
                //]]>
        </script>   
                          <XML id="treeland_Schema" typexml="Schema" ctrlAlert="s_code" ctrlchanged="etpTemplate_treeland_hlbChanged" 
                            ctrlschema="etpTemplate_treeland_hlbWidth" 
                            ctrlstate="etpTemplate_treeland_hlbState" 
                            ctrlhlbcmd="etpTemplate_treeland_hlb_cmd" 
                            ctrlbtcommand="bt_PostBack" 
                            idfld="ID" pidfld="PID" txtfld="DoorName" namefld="" selfid="" valuefld="" typefld="ntype" 
                            orderfld="sn" ntag="" 
                            keyfid="" noexpand="false" 
                            name="edit" relation="M" linkcol="" columnkey="ID" printtype="word">
                            <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
                              <xs:element name="ID" msdata:DataType="System.Guid, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" type="xs:string" minOccurs="0" />
                              <xs:element name="PID" msdata:DataType="System.Guid, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" type="xs:string" minOccurs="0" />
                              <xs:element name="ControlNo" type="xs:int" minOccurs="0" expression="ControlNo[-1]+1"/>
					            <xs:element name="serialno" type="xs:string" minOccurs="0" title="门禁序号" />
					            <xs:element name="ReadNo" type="xs:string" minOccurs="0" dataitem="execute dbo.doorreadno" textcol="name" valuecol="name" title="读头号" />
					            <xs:element name="DoorName" type="xs:string" minOccurs="0" chkcol="1" title="名称" />
					            <xs:element name="workmode" type="xs:int" minOccurs="0" expression="'2'"/>
					            <xs:element name="IP" type="xs:string" minOccurs="0"/>
					            <xs:element name="Port" type="xs:string" minOccurs="0" title="端口" />
					            <xs:element name="Watch" type="xs:boolean" minOccurs="0" title="是否实时监控" />
					            <xs:element name="xPos" type="xs:int" minOccurs="0" title="x坐标" />
					            <xs:element name="yPos" type="xs:int" minOccurs="0" title="y坐标" />
					            <xs:element name="IsKq" type="xs:int" minOccurs="0" />
					            <xs:element name="ntype" type="xs:string" minOccurs="0" />
					            <xs:element name="sn" type="xs:int" minOccurs="0" />
                              <xs:element name="RowNum" type="xs:int" minOccurs="0" visible="1" />
                            </xs:schema>
                          </XML>
                          
                          
                          
                          
                          <script language="javascript"> var myTree=new Tree(etpTemplate_treeland_trvLand,'门禁权限');</script>
                          </fieldset>
                </td>
                <td style="height:100%;border-left-style:none; border-left-width:medium" valign="top">
<table border="0" width="100%" height="100%" cellpadding="0" style="border-collapse: collapse" id="mainTable">
<tbody>
	<tr>
		<td><fieldset style="padding: 10;width:99%;height:100%;border:1px inset">
                  <legend style="padding:1px;">监控信息</legend>
                  <br /><br />
                  正在采集的门禁控制器：<input id="txtdev" type="text" name="T1" size="20" style="width:200px" />
                  <br /><br />
                  该控制器已采集数量：　<input id="txti" type="text" name="T1" size="20" style="width:200px" />
                  <br /><br />
                  该控制器总记录数量：　<input id="txtcount" type="text" name="T1" size="20" style="width:200px" />
                  <br /><br />
    </fieldset>
</td>
	</tr>
	<tr style="height:20px">
		<td>
		<input type="button" id="btncollect" value="采集" name="B3" class="standbtn" onclick="getdoordata()"/>
		<input type="button" value="清除信息" name="B3" class="standbtn" onclick="cleargrid('tableDiv')"/>
		<input type="button" value="返回" name="B3" class="standbtn" onclick="ms_close()"/>		
		</td>
	</tr>
</tbody>	
<tbody style="display:none;">
	<tr>
		<td><fieldset style="padding: 10;width:99%;height:100%;border:1px inset">
                  <legend style="padding:1px;">读取白名单</legend>
                  <div id="tableDiv" style="width:100%;height:95%"></div>
    </fieldset>
</td>
	</tr>
	<tr style="height:20px">
		<td>
		<input type="button" value="读取" name="B3" class="standbtn" onclick="cleargrid('tableDiv');readwhite()"/>
		<input type="button" value="清除信息" name="B3" class="standbtn" onclick="cleargrid('tableDiv')"/>
		<input type="button" value="返回" name="B3" class="standbtn" onclick="ms_close()"/>
		</td>
	</tr>
</tbody>	
<tbody style="display:none;">
	<tr>
		<td><fieldset style="padding: 10;width:99%;height:100%;border:1px inset">
                  <legend style="padding:1px;">读取设备信息</legend>
                  <div id="devinfo" style="width:100%;height:95%"></div>
    </fieldset>
</td>
	</tr>
	<tr style="height:20px">
		<td>
		<input type="button" value="读取" name="B3" class="standbtn" onclick="readdevinfo()"/>
		<input type="button" value="清除信息" name="B3" class="standbtn" onclick="cleargrid('devinfo')"/>
		<input type="button" value="返回" name="B3" class="standbtn" onclick="ms_close()"/>
		</td>
	</tr>
</tbody>	
</table>
            </td>
            </tr>
            </tbody>
</table>
<img id="imgthread" border="0" src="images/thread.gif" style="display:none;position:absolute;left:expression(document.body.clientWidth/2-this.width/2);top:expression(document.body.clientHeight/2-this.height/2)" />
        </body>
  </body>
</html>